<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
    <title>Cloudnest</title>
    <link rel="shortcut icon" href="/images/cloudnest.png" type="image/x-icon">
    <link href="https://fonts.googleapis.com/css2?family=Nova+Round&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet"
        href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css">
    <link rel="stylesheet" href="/css/style2.css">
</head>

<body onload="load_data()">
    
    <div id="loader" class="center"></div>
    <input type="checkbox" id="nav-toggle">
    <div class="sidebar">
        <div class="sidebar-brand">
            <h2><span>Cloudnest</span></h2>
        </div>

        <div class="sidebar-menu">
            <ul>
                <li>
                    <a href="/password-page" class="active" ><span class="las la-key"></span> <span>Passwords</span></a>
                </li>
                <li>
                    <a href="/notes-page"><span class="las la-clipboard"></span> <span>Notes</span></a>
                </li>

            </ul>
        </div>
    </div>

    <div class="main-content">
        <header>
            <h2>
                <label for="nav-toggle">
                    <span class="las la-bars"></span>
                </label>
                Passwords
            </h2>
            {{!-- delete popup --}}
            <div class="confirm-delete" id="confirm_delete">
            <div class="confirm-delete-window">
            <h4>Are you sure?</h4>
            <div>
                <button onclick="confirm_delete_yes()">Yes</button>
                <button onclick="confirm_delete_no()">No</button>
            </div>
            </div>
            </div>

            <h4 id="alert" class="alertmsg-error1" role="alert"></h4>
            <h4 id="alert_success" class="alertmsg-success" role="alert"></h4>
            <h4 id="alert_search" class="alertmsg-search" role="alert"></h4>
            {{#if error}}
            <h4 id="alert_msg" class="alertmsg-error" role="alert">{{message}}<a href="#" onclick="random_close()"><span class="la la-close"
                        style="float: right; "></span></a></h4>
            {{else}}{{#if success}}
            <h4 id="alert_msg" class="alertmsg-success" role="alert">{{message}}<a href="#" onclick="random_close()"><span
                        class="la la-close" style="float: right;"></span></a></h4>
            {{/if}}{{/if}}
            {{!-- modal content --}}

            
             
            <div class="search-wrapper">
                <span class="las la-search"></span>
                <input type="input" placeholder="Search here" id="myInput" onkeyup="search_function()" />
            </div>
            
            <div class="user-wrapper">
                 
                 <img src="#" alt="Profile picture" width="50px" height="50px" id="profile_picture">
                <div class="menu-bar">
                    <ul>
                        <li>
                            <i class="las la-chevron-down"></i>
                        <div class="sub-menu">
                            <ul>
                                <li></i><a href="/account"><i class="las la-user"></i>Account</a></li>
                                {{!-- <li><a href="#"><i class="las la-cog"></i>Settings</a></li> --}}
                                <li><a href="/login" onclick="logout()"><i class="las la-power-off"></i>Log Out</a></li>
                            </ul>
                        </div>
                    </li>
                </ul>
                </div>
                 {{!-- {{#each rows}} --}}
                <h4 style="margin-right: 5px;">Hi,</h4>
                <h4 id="user_name"></h4>
                {{!-- {{/each}}
                {{#each rows}}
                <small>User ID: {{this.userid}} </small>
                {{/each}} --}}

            </div>
        </header>

        <main>

            <div class="cards">
                <div class="card-single">
                    <div>
                        <h1 id="total_entry">5</h1>
                        <span>Total entry</span>
                    </div>
                    <div>
                        <span class="las la-plus-circle"></span>
                    </div>
                </div>

                <div class="card-single">
                    <div>
                        <h1 id="websites">5</h1>
                        <span>Website</span>
                    </div>
                    <div>
                        <span class="las la-globe"></span>
                    </div>
                </div>

                <div class="card-single">
                    <div>
                        <h1 id="password_count">5</h1>
                        <span>Passwords</span>
                    </div>
                    <div>
                        <span class="las la-key"></span>
                    </div>
                </div>

                <div class="card-single">
                    <div>
                        <h1>AES</h1>
                        <span>Encryption</span>
                    </div>
                    <div>
                        <span class="las la-lock"></span>
                    </div>
                </div>
            </div>

            <div class="recent-grid">
                <div class="projects">
                    <div class="card">
                        <div class="card-header">
                            <h3>Password Wallet</h3>
                            <div>
                                <button class="add" onclick="add_new()"><span>Add</span></button>
                                <button class="eye" onclick="view()"><span>View</span></button>
                                <button class="delete" onclick="table_edit()"><span>Edit</span></button>
                                <button class="delete" onclick="confirm_delete()"><span>Delete</span></button>
                            </div>
                        </div>

                        <div class="card-body">
                            <div class="table-responsive">
                                <table width="100%" id="pass_table">
                                    <thead>
                                        <tr>
                                            <td></td>
                                            <td>Website title</td>
                                            <td>Website URL</td>
                                            <td>Username</td>
                                            <td>Password</td>
                                        </tr>
                                    </thead>
                                    <tbody id="tableData">
                                        
                       
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- <div class="customers">
                    <div class="card">
                        
                        
                                              
                    </div>-->
                
            </div>
    
    </div>

    <div class="bg-modal" id="modal">
        {{!-- <form action="/password/encrypt" method="POST"> --}}

        <div class="modal-content" id="modal_add_first">
            <div class="title">
                <p>Add Password</p><a href="#" onclick="modal_close()"><span class="la la-close"></span></a>
            </div>
            <p class="note_msg"><b>NOTE: </b>Your Account Password is used to encrypt your data for safe storage, keep it safe. Don't share it with anyone.</p><br>
            <label class="pass" >Password:</label><input class="acc_pass" type="password"
                placeholder="Type your account password here" id="input_pass" name="account_pass">
            {{!-- <button class="add_rec" onclick="add_next()">Continue</button> --}}
            <a class="next_btn" href="#" onclick="add_next()">Next</a>
            
        </div>
        

        
        <div class="modal-content" id="modal_add_second">
            <div class="title">
                <p> Add a new Password</p><a href="#" onclick="modal_close()"><span class="la la-close"></span></a>
            </div>
            <label class="name" >Name of the website:</label><input class="web_name" type="text" name="website"
                placeholder="e.g. Facebook, Twitter, Amazon" id="input_website"><br>
            <label class="url" >URL of website:</label><input class="web_link" type="text" name="url"
                placeholder="Enter the URL of the website here" id="input_website_url">
            <label class="usr" >Username:</label><input class="web_usr" type="text" placeholder="Type your username here"
                id="input_email" name="input_email">
            <label class="pass" >Password:</label><input class="web_pass" type="password"
                placeholder="Type your password here" id="input_web_pass" name="pass">
            {{!-- <button class="add_rec" onclick="//add_previous()">Previous</button> --}}

            <br><br><a class="prev_btn" href="#" onclick="add_previous()">Previous</a>
            <button class="add_rec" onclick="add_record_api()">Add Record</button>
            {{!-- </form> --}}
        </div>

        <div class="modal-content" id="modal_view_first">
            <div class="title">
                <p>View Password</p><a href="#" onclick="modal_close()"><span class="la la-close"></span></a>
            </div>
            <p class="note_msg"><b>NOTE:</b>Your Account Password is used to encrypt your data for safe storage, keep it safe. Don't share it with anyone.</p><br>
            <label class="pass" >Password:</label><input class="acc_pass" type="password"
                placeholder="Type your account password here" id="input_view_pass" name="account_pass" required>
            {{!-- <button class="add_rec" onclick="add_next()">Continue</button> --}}
            <a class="next_btn" href="#" onclick="view_next()">Next</a>
            
        </div>
        <div class="modal-content" id="modal_view">
            <div class="title">
                <p> View Password</p><a href="#" onclick="modal_close()"><span class="la la-close"></span></a>
            </div>
            <label class="name">Name of the website:</label><a class="view_name" id="modal_view_site"></a><br><br>
            <label class="usr">Username:</label><label class="view_usr" id="modal_view_name"></label><br><br>
            <label class="pass">Password:</label><input id="modal_view_pass" disabled><br><br>
            <button class="add_rec" onclick="copy()">Copy Password</button>

        </div>
        <div class="modal-content" id="modal_edit_first">
            <div class="title">
                <p>Edit Password</p><a href="#" onclick="modal_close()"><span class="la la-close"></span></a>
            </div>
            <p class="note_msg"><b>NOTE:</b>Your Account Password is used to encrypt your data for safe storage, keep it safe. Don't share it with anyone.</p><br>
            <label class="pass" >Password:</label><input class="acc_pass" type="password"
                placeholder="Type your account password here" id="input_edit_pass" name="account_pass" required>
            <a class="next_btn" href="#" onclick="edit_next()">Next</a>
        </div>

        <div class="modal-content" id="modal_edit">
            
            <div class="title">
                <p>Edit Password</p><a href="#" onclick="modal_close()"><span class="la la-close"></span></a>
            </div>
            <label class="name">Name of the website:</label><input class="web_name" type="text"
                placeholder="Website" id="edit_website_name" disabled>
            <label class="url" >Link of website:</label><input class="web_link" type="text" name="url"
                placeholder="Enter the URL of the website here" id="edit_website_url">
            <label class="usr">Username:</label><input class="web_usr" type="text" placeholder="Type your username here"
                id="edit_email" disabled>
            <label class="pass">Password:</label><input class="web_pass" type="text" placeholder="Type your new password here"
                id="edit_pass">
            <br><br><a class="prev_btn" href="#" onclick="edit_previous()">Previous</a>
            <button class="add_rec" onclick="edit()">Update Record</button>
            
        </div>
    </div>
    </main>

    </div>

    <script src="/js/function.js"></script>
    <script>
        var userid = "";
        function random_close() {
            let modal = document.getElementById("alert_msg");
            modal.style.display = "none";
            
        }
        function modal_create() {

            let new_website = document.getElementById("input_website");
            let new_email = document.getElementById("input_email");
            var new_pass = document.getElementById("input_pass");
            let modal = document.getElementById("modal");

            persondata.push({ sl: '<input type="checkbox">', site: new_website.value, usr: new_email.value, pass: new_pass.value })
            loadTableData(persondata);
            modal.style.display = "none";

            new_pass.value = "";
            new_website.value = "";
            new_email.value = "";
        }
        function modal_close() {
            let modal = document.getElementById("modal");
            let body= document.getElementById("body");
            modal.style.display = "none";
        }
        function add_new() {
            let modal = document.getElementById("modal");
            let modal_add_first = document.getElementById("modal_add_first");
            let modal_add_second = document.getElementById("modal_add_second");
            let modal_view = document.getElementById("modal_view");
            let modal_view_first = document.getElementById("modal_view_first");
            let modal_edit = document.getElementById("modal_edit");
            let modal_edit_first = document.getElementById("modal_edit_first");
            let account_pass = document.getElementById("input_pass");
            account_pass.value = "";

            modal_edit.style.display = "none";
            modal.style.display = "flex";
            modal_add_first.style.display = "block"
            modal_add_second.style.display = "none";
            modal_view.style.display = "none";
            modal_view_first.style.display = "none";
            modal_edit_first.style.display = "none";
        }
        function table_view() {
            let modal = document.getElementById("modal");
            let modal_view = document.getElementById("modal_view");
            let modal_add_second = document.getElementById("modal_add_second");
            var modal_edit = document.getElementById("modal_edit");

            modal_edit.style.display = "none";
            modal.style.display = "flex";
            modal_add_second.style.display = "none";
            modal_view.style.display = "block";

            count = 0;

            let table = document.getElementById("pass_table");
            let tr = table.getElementsByTagName('tr');
            let modal_view_site = document.getElementById("modal_view_site");
            let modal_view_pass = document.getElementById("modal_view_pass");
            let modal_view_name = document.getElementById("modal_view_name");
            for (var i = 1; i < tr.length; i++) {
                let td = tr[i].getElementsByTagName('td')[0];
                let chk_box = td.getElementsByTagName('input')[0];
                if (chk_box.checked == true) {
                    count += 1;
                    value = tr[i].getElementsByTagName('td')[1].innerHTML;
                    position = i;
                } else {
                    // console.log(tr[i].getElementsByTagName('td')[1].textContent,"not checked");
                }
            }
            if (count > 1) {
                console.log("Select One");
            }
            if (count == 1) {
                console.log(persondata[position - 1].site);
                modal_view_site.innerHTML = "persondata[position - 1].site";
                modal_view_site.href = "https://www.youtube.com/";
                modal_view_name.innerHTML = "persondata[position - 1].usr";
                modal_view_pass.value = "persondata[position - 1].pass";
            }

        }

        function copy() {
            var pass = document.getElementById("modal_view_pass");
            pass.disabled = false;
            pass.select();
            document.execCommand("copy");
            pass.disabled = true;
        }
        function table_edit() {
            
            let modal = document.getElementById("modal");
            let modal_view = document.getElementById("modal_view");
            let modal_view_first = document.getElementById("modal_view_first");
            let modal_add_first = document.getElementById("modal_add_first");
            let modal_add_second = document.getElementById("modal_add_second");
            let modal_edit = document.getElementById("modal_edit");
            let modal_edit_first = document.getElementById("modal_edit_first");

            let input_pass = document.getElementById("input_edit_pass");

            input_pass.value = "";

            var count = 0;
            var position = 1;

            let table = document.getElementById("pass_table");
            let tr = table.getElementsByTagName('tr');

            for(var i=1;i<tr.length;i++)
            {
                let td = tr[i].getElementsByTagName('td')[0];
                let chk_box = td.getElementsByTagName('input')[0];
                
                if(chk_box.checked == true){
                    count +=1;
                    position = i;
                    
                }
                else{
                    {{!-- console.log("Choose a value"); --}}
                }

            }
            if(count==0){
                console.log("Select only one value");
                const alert = document.getElementById("alert");
                alert.style.display="block";
                alert.innerHTML="Select one value";
                setTimeout(() =>alert.style.display = "none",3000);
            }else if(count>1){
                console.log("Select only one value");
                const alert = document.getElementById("alert");
                alert.style.display="block";
                alert.innerHTML="Select only one value";
                setTimeout(() =>alert.style.display = "none",3000);
            }else{
                
            modal_add_second.style.display = "none";
            modal_view.style.display = "none";
            modal_view_first.style.display = "none";
            modal_add_first.style.display = "none";
            modal.style.display = "flex";
            modal_edit.style.display = "none";
            modal_edit_first.style.display = "block";
            
            
            
            }
        }
        async function edit_next() {
            var website_name="";
            var website_link="";
            var website_usr="";
            let modal = document.getElementById("modal");
            let modal_view = document.getElementById("modal_view");
            let modal_view_first = document.getElementById("modal_view_first");
            let modal_add_first = document.getElementById("modal_add_first");
            let modal_add_second = document.getElementById("modal_add_second");
            let modal_edit = document.getElementById("modal_edit");
            let modal_edit_first = document.getElementById("modal_edit_first");

            let account_pass = document.getElementById("input_edit_pass");
            var input_pass = account_pass.value;
            const data = {input_pass};
            const options = {
                headers: {
                    'Content-Type': 'application/json'
                },
                method: 'POST',
                body: JSON.stringify(data)
            };
            const response = await fetch('/password/check-password',options);
            const json_data = await response.json();
            userid=json_data.user;

            if(json_data.state){
                modal_add_second.style.display = "none";
                modal_view.style.display = "none";
                modal_view_first.style.display = "none";
                modal_add_first.style.display = "none";
                modal.style.display = "flex";
                modal_edit.style.display = "block";
                modal_edit_first.style.display = "none";

                var count = 0;
                var position = 1;

                let table = document.getElementById("pass_table");
                let tr = table.getElementsByTagName('tr');

                for(var i=1;i<tr.length;i++)
                {
                    let td = tr[i].getElementsByTagName('td')[0];
                    let chk_box = td.getElementsByTagName('input')[0];
                    
                    if(chk_box.checked == true){
                        count +=1;
                        position = i;
                        
                    }
                    else{
                        
                    }

                }
                website_name = tr[position].getElementsByTagName('td')[1].innerHTML;
                website_link = tr[position].getElementsByTagName('td')[2].innerHTML;
                website_usr = tr[position].getElementsByTagName('td')[3].innerHTML;

                console.log(website_name,website_link,website_usr);

                const data = {website_name,website_link,website_usr,input_pass};
                const options = {
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    method: 'POST',
                    body: JSON.stringify(data)
                };
                const response = await fetch('/password/view-password',options);
                const json_data = await response.json();
                
                const edit_website_name = document.getElementById("edit_website_name");
                const edit_website_url = document.getElementById("edit_website_url");
                const edit_email = document.getElementById("edit_email");
                const edit_pass = document.getElementById("edit_pass");
                edit_website_name.disabled="false";
                edit_website_name.value = json_data.website;
                edit_website_name.disabled="true";
                edit_website_url.value = json_data.website_url;
                edit_email.disabled = "false";
                edit_email.value = json_data.user;
                edit_email.disabled = "true";
                edit_pass.value = json_data.password;


            }else{
                const alert = document.getElementById("alert");
                alert.style.display="block";
                alert.innerHTML="Wrong Password";
                setTimeout(() =>alert.style.display = "none",3000);
            }
            
        }
        async function edit(){
            let modal = document.getElementById("modal");
            let modal_view = document.getElementById("modal_view");
            let modal_view_first = document.getElementById("modal_view_first");
            let modal_add_first = document.getElementById("modal_add_first");
            let modal_add_second = document.getElementById("modal_add_second");
            let modal_edit = document.getElementById("modal_edit");
            let modal_edit_first = document.getElementById("modal_edit_first");


            let input_pass = document.getElementById("input_edit_pass").value;
            let edit_website_name = document.getElementById("edit_website_name");
            let edit_website_url = document.getElementById("edit_website_url");
            let edit_email = document.getElementById("edit_email");
            let edit_pass = document.getElementById("edit_pass");
            {{!-- console.log(edit_website_name.value,edit_website_url.value);
            console.log(input_pass); --}}
            const input_email = edit_email.value;
            const input_web_pass = edit_pass.value;
            const input_website = edit_website_name.value;
            const input_website_url = edit_website_url.value;
            console.log(input_email,input_web_pass);
            
            if(edit_website_url.value==""||edit_pass.value=="")
            {
                const alert = document.getElementById("alert");
                alert.style.display="block";
                alert.innerHTML="Fill all fields";
                setTimeout(() =>alert.style.display = "none",3000);
            }else{
                
                const data = {userid,input_pass,input_website,input_website_url,input_email,input_web_pass};
                const options = {
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    method: 'POST',
                    body: JSON.stringify(data)
                };
                const response = await fetch('/password/update-password',options);
                const json_data = await response.json();

                if(json_data.state)
                {
                    const alert = document.getElementById("alert_success");
                    alert.style.display="block";
                    alert.innerHTML=json_data.message;
                    setTimeout(() =>alert.style.display = "none",3000);
                    load_data();
                    modal_add_second.style.display = "none";
                    modal_view.style.display = "none";
                    modal_view_first.style.display = "none";
                    modal_add_first.style.display = "none";
                    modal.style.display = "none";
                    modal_edit.style.display = "none";
                    modal_edit_first.style.display = "none";
                }
            }
            
        }
        function edit_previous(){
            let modal = document.getElementById("modal");
            let modal_view = document.getElementById("modal_view");
            let modal_view_first = document.getElementById("modal_view_first");
            let modal_add_first = document.getElementById("modal_add_first");
            let modal_add_second = document.getElementById("modal_add_second");
            let modal_edit = document.getElementById("modal_edit");
            let modal_edit_first = document.getElementById("modal_edit_first");

            modal_add_second.style.display = "none";
            modal_view.style.display = "none";
            modal_view_first.style.display = "none";
            modal_add_first.style.display = "none";
            modal.style.display = "flex";
            modal_edit.style.display = "none";
            modal_edit_first.style.display = "block";
        }
        function eye() {
            var x = document.getElementById("pass");
            var y = document.getElementById("hide1");
            var z = document.getElementById("hide2");

            if (x.type === 'password') {
                x.type = 'text';
                y.style.display = "block";
                z.style.display = "none";
            }
            else {
                x.type = 'password';
                y.style.display = "none";
                z.style.display = "block";
            }
        }

        function add_previous(){
            let modal = document.getElementById("modal");
            let modal_add_first = document.getElementById("modal_add_first");
            let modal_add_second = document.getElementById("modal_add_second");
            let modal_view_first = document.getElementById("modal_view_first");
            let modal_view = document.getElementById("modal_view");
            let modal_edit = document.getElementById("modal_edit");
            let modal_edit_first = document.getElementById("modal_edit_first");

            
            modal.style.display = "flex";
            modal_add_first.style.display = "block";
            modal_add_second.style.display = "none";
            modal_view.style.display = "none";
            modal_view_first.style.display = "none";
            modal_edit.style.display = "none";
            modal_edit_first.style.display = "none";
        }
        async function add_next(){
            let modal = document.getElementById("modal");
            let modal_add_first = document.getElementById("modal_add_first");
            let modal_add_second = document.getElementById("modal_add_second");
            let modal_view = document.getElementById("modal_view");
            let modal_view_first = document.getElementById("modal_view_first");
            let modal_edit = document.getElementById("modal_edit");
            let modal_edit_first = document.getElementById("modal_edit_first");
            let account_pass = document.getElementById("input_pass");
            var input_pass = account_pass.value;

            const data = {input_pass};
            const options = {
                headers: {
                    'Content-Type': 'application/json'
                },
                method: 'POST',
                body: JSON.stringify(data)
            };
            const response = await fetch('/password/check-password',options);
            const json_data = await response.json();
            userid = json_data.user;
            console.log(userid);
            if(json_data.state)
            {
                modal.style.display = "flex";
                modal_add_first.style.display = "none";
                modal_add_second.style.display = "block";
                modal_view.style.display = "none";
                modal_view_first.style.display = "none";
                modal_edit.style.display = "none";
                modal_edit_first.style.display = "none";
            }else{
                const alert = document.getElementById("alert");
                alert.style.display="block";
                alert.innerHTML="Wrong Password";
                setTimeout(() =>alert.style.display = "none",3000);
            }
            
        }
        async function add_record_api(){
            const input_email = document.getElementById("input_email").value;
            const input_web_pass = document.getElementById("input_web_pass").value;
            const input_website = document.getElementById("input_website").value;
            const input_website_url = document.getElementById("input_website_url").value;
            const input_pass = document.getElementById("input_pass").value;
            if(input_email==""||input_web_pass==""||input_website==""||input_website_url=="")
            {
                const alert = document.getElementById("alert");
                alert.style.display="block";
                alert.innerHTML="Fill all fields";
                setTimeout(() =>alert.style.display = "none",3000);
            }else{
                const data = {userid,input_pass,input_email,input_web_pass,input_website,input_website_url};
                const options = {
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    method: 'POST',
                    body: JSON.stringify(data)
                };
                const response = await fetch('/password/add-password',options);
                const json_data = await response.json();
                
                if(json_data.state)
                {
                    console.log("added");
                    const alert = document.getElementById("alert_success");
                    alert.style.display="block";
                    alert.innerHTML=json_data.message;
                    setTimeout(() =>alert.style.display = "none",3000);
                    load_data();
                    modal.style.display = "none";
                    modal_add_first.style.display = "none";
                    modal_add_second.style.display = "none";
                    modal_view.style.display = "none";
                    modal_view_first.style.display = "none";
                    modal_edit.style.display = "none";
                    modal_edit_first.style.display = "none";
                }else{
                    const alert = document.getElementById("alert");
                    alert.style.display="block";
                    alert.innerHTML=json_data.message;
                    setTimeout(() =>alert.style.display = "none",3000);
                }
            }
            
        }
        function view(){

            var website_name="";
            var website_link="";
            var website_usr="";
            let modal = document.getElementById("modal");
            let modal_view = document.getElementById("modal_view");
            let modal_view_first = document.getElementById("modal_view_first");
            let modal_add_first = document.getElementById("modal_add_first");
            let modal_add_second = document.getElementById("modal_add_second");
            let modal_edit = document.getElementById("modal_edit");
            let modal_edit_first = document.getElementById("modal_edit_first");
            

            
            

            let modal_view_site = document.getElementById("modal_view_site");
            let modal_view_pass = document.getElementById("modal_view_pass");
            let modal_view_name = document.getElementById("modal_view_name");

            var count = 0;
            var position = 1;

            let table = document.getElementById("pass_table");
            let tr = table.getElementsByTagName('tr');

            for(var i=1;i<tr.length;i++)
            {
                let td = tr[i].getElementsByTagName('td')[0];
                let chk_box = td.getElementsByTagName('input')[0];
                
                if(chk_box.checked == true){
                    count +=1;
                    position = i;
                    
                }
                else{
                    {{!-- console.log("Choose a value"); --}}
                }

            }
            if(count==0){
                console.log("Select only one value");
                const alert = document.getElementById("alert");
                alert.style.display="block";
                alert.innerHTML="Select one value";
                setTimeout(() =>alert.style.display = "none",3000);
            }else if(count>1){
                console.log("Select only one value");
                const alert = document.getElementById("alert");
                alert.style.display="block";
                alert.innerHTML="Select only one value";
                setTimeout(() =>alert.style.display = "none",3000);
            }else{
                
            modal_edit.style.display = "none";
            modal.style.display = "flex";
            modal_add_second.style.display = "none";
            modal_view_first.style.display = "block";
            modal_view.style.display = "none";
            modal_add_second.display = "none";
            modal_add_first.style.display = "none";
            modal_edit_first.style.display = "none";
            
            
            
            }

    
        }
        async function view_next(){
            var website_name="";
            var website_link="";
            var website_usr="";
                let modal = document.getElementById("modal");
                let modal_view = document.getElementById("modal_view");
                let modal_view_first = document.getElementById("modal_view_first");
                let modal_add_first = document.getElementById("modal_add_first");
                let modal_add_second = document.getElementById("modal_add_second");
                var modal_edit = document.getElementById("modal_edit");

                

                let modal_view_site = document.getElementById("modal_view_site");
                let modal_view_pass = document.getElementById("modal_view_pass");
                let modal_view_name = document.getElementById("modal_view_name");

                let view_input_pass = document.getElementById("input_view_pass");

                var count = 0;
                var position = 1;

                let table = document.getElementById("pass_table");
                let tr = table.getElementsByTagName('tr');

                for(var i=1;i<tr.length;i++)
                {
                    let td = tr[i].getElementsByTagName('td')[0];
                    let chk_box = td.getElementsByTagName('input')[0];
                    
                    if(chk_box.checked == true){
                        count +=1;
                        position = i;
                        
                    }
                    else{
                        {{!-- console.log("Choose a value"); --}}
                    }

                }
                if(count==0){
                    console.log("Select only one value");
                    const alert = document.getElementById("alert");
                    alert.style.display="block";
                    alert.innerHTML="Select one value";
                    setTimeout(() =>alert.style.display = "none",3000);
                }else if(count>1){
                    console.log("Select only one value");
                    const alert = document.getElementById("alert");
                    alert.style.display="block";
                    alert.innerHTML="Select only one value";
                    setTimeout(() =>alert.style.display = "none",3000);
                }else{
                    // Main function to send data
                modal_edit.style.display = "none";
                modal.style.display = "flex";
                modal_add_second.style.display = "none";
                modal_add_first.style.display = "none";
                {{!-- modal_view_first.style.display = "none"; --}}
                {{!-- modal_view.style.display = "block"; --}}

                website_name = tr[position].getElementsByTagName('td')[1].innerHTML;
                website_link = tr[position].getElementsByTagName('td')[2].innerHTML;
                website_usr = tr[position].getElementsByTagName('td')[3].innerHTML;
                input_pass = view_input_pass.value;
                console.log(website_link,website_name,website_usr);

                const data = {website_name,website_link,website_usr,input_pass};
                const options = {
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    method: 'POST',
                    body: JSON.stringify(data)
                };
                const response = await fetch('/password/view-password',options);
                const json_data = await response.json();
                
                if(json_data.state)
                {   
                    modal_view_first.style.display = "none";
                    modal_view.style.display = "block";
                    modal_view.style.display = "block";
                    modal_view_name.innerHTML=json_data.user;
                    modal_view_site.innerHTML=json_data.website;
                    modal_view_site.href=json_data.website_url;
                    modal_view_pass.value=json_data.password;
                    modal_view_pass.disabled=true;

                    view_input_pass.value="";
                }else{
                    const alert = document.getElementById("alert");
                    view_input_pass.value="";
                    alert.style.display="block";
                    alert.innerHTML=json_data.message;
                    setTimeout(() =>alert.style.display = "none",1000);
                    
                };
                
                
                
                }

        }
        function confirm_delete(){
            var delete_div = document.getElementById("confirm_delete");
            const alert = document.getElementById("alert");
            let modal = document.getElementById("modal");
            let modal_view = document.getElementById("modal_view");

            var count = 0;
            var position = 1;

            let table = document.getElementById("pass_table");
            let tr = table.getElementsByTagName('tr');

            for(var i=1;i<tr.length;i++)
            {
                let td = tr[i].getElementsByTagName('td')[0];
                let chk_box = td.getElementsByTagName('input')[0];
                
                if(chk_box.checked == true){
                    count +=1;
                    position = i;
                    
                }
                else{
                    {{!-- console.log("Choose a value"); --}}
                }

            }
            if(count==0){
                console.log("Select only one value");
                alert.style.display="block";
                alert.innerHTML="Select one value";
                setTimeout(() =>alert.style.display = "none",3000);
            }else if(count>1){
                console.log("Select only one value");
                
                alert.style.display="block";
                alert.innerHTML="Select only one value";
                setTimeout(() =>alert.style.display = "none",3000);
            }else{
                alert.style.display = "none"
                delete_div.style.display = "block";
                {{!-- modal.style.display = "block"; --}}
            
            }
            

        }
        function confirm_delete_no(){
            var delete_div = document.getElementById("confirm_delete");
            delete_div.style.display = "none";
        }
        async function confirm_delete_yes(){
            var delete_div = document.getElementById("confirm_delete");

            var website_name="";
            var website_link="";
            var website_usr="";

            var count = 0;
            var position = 1;

            let table = document.getElementById("pass_table");
            let tr = table.getElementsByTagName('tr');

            for(var i=1;i<tr.length;i++)
            {
                let td = tr[i].getElementsByTagName('td')[0];
                let chk_box = td.getElementsByTagName('input')[0];
                
                if(chk_box.checked == true){
                    count +=1;
                    position = i;
                    
                }
                else{
                    {{!-- console.log("Choose a value"); --}}
                }

            }
            
            website_name=tr[position].getElementsByTagName('td')[1].innerHTML;
            website_usr=tr[position].getElementsByTagName('td')[3].innerHTML;
            console.log(website_name,website_usr);
            const data = {website_name,website_usr};
            const options = {
                headers: {
                    'Content-Type': 'application/json'
                },
                method: 'POST',
                body: JSON.stringify(data)
            };
            const response = await fetch('/password/delete-password',options);
            const json_data = await response.json();
            if(json_data.state)
            {
                delete_div.style.display = "none";
                load_data();
            }
            
        }
        async function logout(){
            const options = {
            headers: {
                'Content-Type': 'application/json'
            },
            method: 'GET'

            };
        
            const response = await fetch('/logout',options);
            const json_data = response.json();
            if(json_data.state)
            {
                console.log("Logged out");
            }
        }
        async function load_data(){
        
        const user_name = document.getElementById("user_name");
        const pass_table = document.getElementById("tableData");
        const picture = document.getElementById("profile_picture");
        const total_entry = document.getElementById("total_entry");
        const websites = document.getElementById("websites");
        const passwords_count = document.getElementById("password_count");

       
        const options = {
            headers: {
                'Content-Type': 'application/json'
            },
            method: 'GET',

        };
        
        const response = await fetch('/password/load-data-password',options);
        const json_data = await response.json();
        
        
        var password_data = json_data.passwords;
        let data_html='';
        //console.log(password_data[0].website);
        //----------populating the data--------------------
        total_entry.innerHTML=password_data.length;
        passwords_count.innerHTML=password_data.length;
        user_name.innerHTML=json_data.user.firstname+" "+json_data.user.lastname;
        picture.src=`/uploads/${json_data.user.image}`;
        var counts = new Array();
        var counts = {};
        for (var i = 0; i < password_data.length; i++) {
            counts[password_data[i].website] = 1 + (counts[password_data[i].website] || 0);
        }
        var website_count = Object.keys(counts).length;
        websites.innerHTML = website_count;

        for(var i=0;i<password_data.length;i++)
        {
            
            data_html += `<tr><td><input type="checkbox"></td><td>${password_data[i].website}</td><td>${password_data[i].url}</td><td>${password_data[i].input_email}</td><td>${password_data[i].pass}</td></tr>`;
        };
        
        pass_table.innerHTML = data_html;
        
    }
    </script>

</body>

</html>